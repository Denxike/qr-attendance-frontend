import{j as e}from"./index-DpS5W-O8.js";import{u as E,r as i,L as C}from"./vendor-BCPqKLS0.js";import{a as g}from"./api-BtkNoZFK.js";import{G as T,P,C as D,b as R}from"./icons-DPHu3S6L.js";const U=()=>{const y=E(),[l,v]=i.useState("STUDENT"),[s,I]=i.useState({email:"",password:"",confirmPassword:"",fullName:"",studentId:"",yearOfStudy:"",departmentId:"",phoneNumber:"",employeeId:""}),[r,u]=i.useState({}),[h,m]=i.useState(""),[f,x]=i.useState(""),[p,N]=i.useState(!1),n=a=>{const{name:t,value:c}=a.target;I(o=>({...o,[t]:c})),r[t]&&u(o=>({...o,[t]:""})),m("")},j=a=>{v(a),u({}),m("")},S=()=>{const a={};return s.fullName.trim()||(a.fullName="Full name is required"),s.email?/\S+@\S+\.\S+/.test(s.email)||(a.email="Invalid email format"):a.email="Email is required",s.password?s.password.length<8&&(a.password="Password must be at least 8 characters"):a.password="Password is required",s.confirmPassword?s.password!==s.confirmPassword&&(a.confirmPassword="Passwords do not match"):a.confirmPassword="Please confirm your password",s.departmentId||(a.departmentId="Department is required"),s.phoneNumber||(a.phoneNumber="Phone number is required"),l==="STUDENT"&&(s.studentId.trim()||(a.studentId="Student ID is required"),s.yearOfStudy||(a.yearOfStudy="Year of study is required")),l==="TEACHER"&&(s.employeeId.trim()||(a.employeeId="Employee ID is required")),a},w=async a=>{var c,o;a.preventDefault();const t=S();if(Object.keys(t).length>0){u(t);return}N(!0),m(""),x("");try{if(l==="STUDENT"){const d={email:s.email,password:s.password,fullName:s.fullName,studentId:s.studentId,departmentId:parseInt(s.departmentId),yearOfStudy:parseInt(s.yearOfStudy),phoneNumber:s.phoneNumber};await g.registerStudent(d)}else{const d={email:s.email,password:s.password,fullName:s.fullName,employeeId:s.employeeId,departmentId:parseInt(s.departmentId),phoneNumber:s.phoneNumber};await g.registerTeacher(d)}x("Registration successful! Redirecting to login..."),setTimeout(()=>y("/login"),2e3)}catch(d){const b=((o=(c=d.response)==null?void 0:c.data)==null?void 0:o.message)||"Registration failed. Try again.";m(b)}finally{N(!1)}};return e.jsx("div",{className:"register-container",children:e.jsxs("div",{className:"register-card",children:[e.jsxs("div",{className:"register-header",children:[e.jsx("h1",{children:"Create Account"}),e.jsx("p",{children:"Join the QR Attendance System"})]}),e.jsxs("div",{className:"role-selector",children:[e.jsxs("button",{type:"button",className:`role-btn ${l==="STUDENT"?"active":""}`,onClick:()=>j("STUDENT"),children:[e.jsx("span",{className:"role-icon",children:e.jsx(T,{})}),"Student"]}),e.jsxs("button",{type:"button",className:`role-btn ${l==="TEACHER"?"active":""}`,onClick:()=>j("TEACHER"),children:[e.jsx("span",{className:"role-icon",children:e.jsx(P,{})}),"Teacher"]})]}),h&&e.jsxs("div",{className:"alert-error",children:[e.jsx(D,{})," ",h]}),f&&e.jsxs("div",{className:"alert-success",children:[e.jsx(R,{})," ",f]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Full Name"}),e.jsx("input",{type:"text",name:"fullName",value:s.fullName,onChange:n,placeholder:"Enter your full name",className:r.fullName?"error":""}),r.fullName&&e.jsx("span",{className:"error-message",children:r.fullName})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email Address"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:n,placeholder:"Enter your email",className:r.email?"error":""}),r.email&&e.jsx("span",{className:"error-message",children:r.email})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Department"}),e.jsxs("select",{name:"departmentId",value:s.departmentId,onChange:n,className:r.departmentId?"error":"",children:[e.jsx("option",{value:"",children:"Select Department"}),e.jsx("option",{value:"1",children:"Computer Science"}),e.jsx("option",{value:"2",children:"Engineering"}),e.jsx("option",{value:"3",children:"Business"}),e.jsx("option",{value:"4",children:"Mathematics"})]}),r.departmentId&&e.jsx("span",{className:"error-message",children:r.departmentId})]}),l==="STUDENT"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Student ID"}),e.jsx("input",{type:"text",name:"studentId",value:s.studentId,onChange:n,placeholder:"e.g. S13/20240/22",className:r.studentId?"error":""}),r.studentId&&e.jsx("span",{className:"error-message",children:r.studentId})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Year of Study"}),e.jsxs("select",{name:"yearOfStudy",value:s.yearOfStudy,onChange:n,className:r.yearOfStudy?"error":"",children:[e.jsx("option",{value:"",children:"Select Year"}),e.jsx("option",{value:"1",children:"Year 1"}),e.jsx("option",{value:"2",children:"Year 2"}),e.jsx("option",{value:"3",children:"Year 3"}),e.jsx("option",{value:"4",children:"Year 4"}),e.jsx("option",{value:"5",children:"Year 5"})]}),r.yearOfStudy&&e.jsx("span",{className:"error-message",children:r.yearOfStudy})]})]})}),l==="TEACHER"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Employee ID"}),e.jsx("input",{type:"text",name:"employeeId",value:s.employeeId,onChange:n,placeholder:"e.g. EMP001",className:r.employeeId?"error":""}),r.employeeId&&e.jsx("span",{className:"error-message",children:r.employeeId})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phoneNumber",value:s.phoneNumber,onChange:n,placeholder:"+254712345678",className:r.phoneNumber?"error":""}),r.phoneNumber&&e.jsx("span",{className:"error-message",children:r.phoneNumber})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",name:"password",value:s.password,onChange:n,placeholder:"Min 8 characters",className:r.password?"error":""}),r.password&&e.jsx("span",{className:"error-message",children:r.password})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:s.confirmPassword,onChange:n,placeholder:"Repeat password",className:r.confirmPassword?"error":""}),r.confirmPassword&&e.jsx("span",{className:"error-message",children:r.confirmPassword})]})]}),e.jsx("button",{type:"submit",className:`btn-register ${p?"loading":""}`,disabled:p,children:p?"":`Create ${l==="STUDENT"?"Student":"Teacher"} Account`})]}),e.jsxs("div",{className:"register-footer",children:["Already have an account?"," ",e.jsx(C,{to:"/login",children:"Sign In"})]})]})})};export{U as default};
